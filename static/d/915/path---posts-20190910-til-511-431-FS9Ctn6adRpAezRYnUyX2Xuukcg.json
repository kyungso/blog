{"data":{"site":{"siteMetadata":{"author":{"name":"Kingso","contacts":{"twitter":"#"}},"disqusShortname":"kingsoblog","subtitle":"Kingso's blog","title":"Kingso's blog","url":"https://kingso.netlify.com"}},"markdownRemark":{"id":"3e69f8c3-ffc0-5b37-9f7f-af5ab2aab9b6","html":"<br>\n<h2 id=\"2019-09-10-til\"><a href=\"#2019-09-10-til\" aria-label=\"2019 09 10 til permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2019-09-10 TIL</h2>\n<br>\n<h2 id=\"인증-시스템\"><a href=\"#%EC%9D%B8%EC%A6%9D-%EC%8B%9C%EC%8A%A4%ED%85%9C\" aria-label=\"인증 시스템 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증 시스템</h2>\n<p>서버에서 세션과 인증된 쿠키를 사용하여 구현합니다.</p>\n<p>인증된 쿠키는 쿠키를 설정할 때, 쿠키 내용과 사전 설정한 비밀 키를 가지고 HMAC(해시 메시지 인증 코드)를 생성하여 함께 보관하는 것입니다. 이것으로 유저가 쿠키를 변조하지 않았음을 검증할 수 있습니다.</p>\n<h3 id=\"서버에-세션-적용\"><a href=\"#%EC%84%9C%EB%B2%84%EC%97%90-%EC%84%B8%EC%85%98-%EC%A0%81%EC%9A%A9\" aria-label=\"서버에 세션 적용 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>서버에 세션 적용</h3>\n<p>백엔드 서버에 세션을 사용하려면 koa-session 라이브러리를 설치해야 합니다</p>\n<p><code class=\"language-text\">$ yarn add koa-session</code></p>\n<br>\n<p>.env</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">PORT=4000\nMONGO_URI-mongodb://localhost/blog\nADMIN_PASS=react123\nCOOKIE_SIGN_KEY=COOKiE$1GNK3Y</code></pre></div>\n<p>koa-session의 기본 설정 값을 자세히 확인하고 싶다면 <a href=\"https://github.com/koajs/session\">https://github.com/koajs/session</a> 을 참고하세요.</p>\n<br>\n<br>\n<h3 id=\"react---redux-개발-흐름\"><a href=\"#react---redux-%EA%B0%9C%EB%B0%9C-%ED%9D%90%EB%A6%84\" aria-label=\"react   redux 개발 흐름 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React - Redux 개발 흐름</h3>\n<ol>\n<li>\n<p>UI 준비하기(프레젠테이셔널 컴포넌트 만들기)</p>\n</li>\n<li>\n<p>리덕스 상태 관리하기</p>\n</li>\n<li>\n<p>컨테이너 컴포넌트 만들기</p>\n</li>\n</ol>\n<p>이 세 가지 작업을 반복!!</p>\n<br>\n<br>\n<h2 id=\"서버사이드-렌더링\"><a href=\"#%EC%84%9C%EB%B2%84%EC%82%AC%EC%9D%B4%EB%93%9C-%EB%A0%8C%EB%8D%94%EB%A7%81\" aria-label=\"서버사이드 렌더링 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>서버사이드 렌더링</h2>\n<h5 id=\"검색-엔진-최적화\"><a href=\"#%EA%B2%80%EC%83%89-%EC%97%94%EC%A7%84-%EC%B5%9C%EC%A0%81%ED%99%94\" aria-label=\"검색 엔진 최적화 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>검색 엔진 최적화</h5>\n<p>페이지가 잘 검색되려면 서버사이드 렌더링이 필요합니다.</p>\n<br>\n<h5 id=\"유저-경험-개선\"><a href=\"#%EC%9C%A0%EC%A0%80-%EA%B2%BD%ED%97%98-%EA%B0%9C%EC%84%A0\" aria-label=\"유저 경험 개선 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>유저 경험 개선</h5>\n<p>서버사이드 렝더링을 하면 유저가 처음 들어왔을 때 자바스크립트를 모두 불러오고, 서비스에서 호출하는 API를 완료할 때까지 기다릴 필요 없이 이를 서버에 미리 실행시켜서 유저에게 제공할 수 있습니다. 따라서 초기 로딩 속도가 조금 더 빨라집니다.</p>\n<h5 id=\"서버사이드-렌더링의-단점\"><a href=\"#%EC%84%9C%EB%B2%84%EC%82%AC%EC%9D%B4%EB%93%9C-%EB%A0%8C%EB%8D%94%EB%A7%81%EC%9D%98-%EB%8B%A8%EC%A0%90\" aria-label=\"서버사이드 렌더링의 단점 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>서버사이드 렌더링의 단점</h5>\n<p>무조건 좋은 것은 아닙니다. 클라이언트에서 처리해야 하는 작업을 서버가 하는 것이기에, 결국 서버의 자원이 소모됩니다. 따라서 서버가 저사양일 때는 서버사이트 렌더링 구현을 권장하지 않습니다.</p>\n<p>그리고 서버에 유저 유입이 순간적으로 늘어나면 서버 성능에 무리가 갈 수 있으므로, 동일한 페이지는 특정 기간 동안 캐싱하여 성능을 최적화할 수 있습니다.</p>\n<p>추가로 서버사이드 렌더링의 의미가 있을 때는 검색 봇이 접근할 때와 처음 들어오는 유저가 사용할 때이므로 개인화된 데이터들은 상황에 따라 서버사이드 렌더링을 하지 않는 것이 적합할 수도 있습니다.(예: 로그인 상태일 때는 서버사이드 렌더링하지 않음)</p>\n<p>또 서버사이드 렌더링을 구현하는 것은 구조가 꽤 복잡합니다.\n단순히 문자열로 렌더링하는 것은 쉽습니다.\n하지만 라우터와 연동하고 리덕스도 사용하면서 API를 활용할 때, 미리 호출하고 코드 스플리팅도 제대로 동작시키려면 다양한 것을 준비해야 합니다. 혼자 진행하려면 매우 복잡한 작업입니다.</p>\n<h3 id=\"서버사이드-렌더링-준비\"><a href=\"#%EC%84%9C%EB%B2%84%EC%82%AC%EC%9D%B4%EB%93%9C-%EB%A0%8C%EB%8D%94%EB%A7%81-%EC%A4%80%EB%B9%84\" aria-label=\"서버사이드 렌더링 준비 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>서버사이드 렌더링 준비</h3>\n<p>서버사이트 렌더링을 구현하려면 클라이언트에서 준비한 컴포넌트 코드를 Node.js에서 사용해야 합니다. 즉, JSX, ES6 문법을 사용해야 한다는 말인데 Node v8 기준으로 ES6 문법의 import/export는 작동하지 않으며, JSX는 당연히 사용할 수 없습니다.</p>\n<p>결국 리액트 관련 코드를 불러오려면 바벨을 사용해야 합니다. 서버에서 바벨을 설정하여 일반 자바스크립트에서는 지원하지 않는 문법들을 사용해야 합니다. 방법은 여러가지 있습니다.</p>\n<p>예를 들어 babel-node를 사용하여 babel preset과 plugin을 적용해서 바로 코드를 실행하는 방법이 있는데, 이 방법을 불필요한 메모리를 추가로 사용하므로 권장하지 않습니다.</p>\n<p>또 런타임에서 코드를 변화하여 실행하는 것이 아니라, 미리 바벨로 변환하여 실행하는 방법도 있습니다. 이 방법은 성능상 문제는 딱히 없지만, 리액트 프로젝트에 필요한 node_modules들이 똑같이 필요하기 때문에 패키지를 동일하게 설치해야 하는 단점이 있습니다. 따라서 서버 파일을 리액트 프로젝트 내부에 작성하는 것이 아니라면 그렇게 좋은 방법이 아닙니다.</p>\n<p>우리는 webpack을 사용합니다. webpack으로 바벨 로더를 적용하여 코드를 변환하고, 파일 하나로 만들 것입니다. 리액트 관련 코드를 서버에서 쉽게 불러와 사용할 수 있습니다.</p>\n<br>\n<h3 id=\"리액트-라이브러리\"><a href=\"#%EB%A6%AC%EC%95%A1%ED%8A%B8-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC\" aria-label=\"리액트 라이브러리 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>리액트 라이브러리</h3>\n<p><a href=\"https://eunajjing.github.io/2019/04/06/react-lib/\">https://eunajjing.github.io/2019/04/06/react-lib/</a></p>","fields":{"slug":"/posts/20190910-TIL/","tagSlugs":["/tag/react/","/tag/cookie/","/tag/session/"]},"frontmatter":{"date":"2019-09-10T14:00:00.169Z","description":"인증 시스템","tags":["React","Cookie","Session"],"title":"[20190910-TIL]"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/20190910-TIL/"}}